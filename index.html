<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Affiliate Link Showcase</title>
  <link
    href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css"
    rel="stylesheet"
  />
</head>
<body class="p-4">
  <h1 class="mb-3">My Amazon Picks</h1>
  <div id="items-list" class="list-group"></div>

  <!-- Tabletop.js for easy Google Sheets integration -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/tabletop.js/1.5.1/tabletop.min.js"></script>
  <script>
    // Initialize Tabletop to fetch your published sheet
    window.onload = function() {
      Tabletop.init({
        key: '12f-5gYolM5ESAxpXTBRyDvW9pvwYivJBRnpQspTOnDo',
        callback: renderItems,
        simpleSheet: true
      });
    };

    // Render function: loops through rows and appends links
    function renderItems(data) {
      const list = document.getElementById('items-list');
      data.forEach(row => {
        const a = document.createElement('a');
        a.href = row.AffiliateLink_Web;             // Column header "AffiliateLink_Web"
        a.textContent = row.Name;      // Column header "Name"
        a.className = 'list-group-item list-group-item-action';
        a.target = '_blank';
        list.appendChild(a);
      });
    }
  </script>
</body>
</html>
